
PL-SAG
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
EXPRESSÃO - Executa na Saída
Sintaxe:
- DG-XCodCida-10*50+{DG-XCodPess}
  - Resultado: 10*50+{Valor do Código da Pessoa}
- CEDXSitLabo-SELECT RetoZero({CE-XMailabo}) FROM DUAL
  - Resultado: Habilita o Campo XSitLabo (Edit) se: XMailabo <> 0
- CEFXSitLabo-SELECT RetoZero({CE-XMailabo}) FROM DUAL
  - Resultado: Executa o Foco no Campo XSitLabo (Edit) se: XMailabo <> 0
- CEVXSitLabo-SELECT RetoZero({CE-XMailabo}) FROM DUAL
  - Resultado: Deixa Visível o Campo XSitLabo (Edit) se: XMailabo <> 0
- DM-XCodCida-SELECT MAX(CodCida) FROM PDCCida
  - Resultado: Retorna a última cidade cadastrada no campo XCodCida (Movimento)
- CE-XCidLabo-{QY-XCodLabo-NomCida}
  - Resultado: Irá buscar no Qry ligado no campo XCodLabo, o campo NomCida
- FV-CE-XCidLabo-{QY-XCodLabo-NomCida}
  - Resultado: Irá buscar no Qry ligado no campo XCodLabo, o campo NomCida, após
retornar do Formulário
- EX-XCidLabo-UPDATE PDCCida SET CodCida = CodCida + 10
  - Resultado: Atualiza o CodCida, acrescentado = 10
----------------------------------------------------------------------------------------------------

- MC-CE-NomeCarg-SELECT {CS-AtivCarg} FROM DUAL
  Quando o cargo esta ativo, é necessário informar um nome. Deseja Continuar?
  - Resultado: Quando o Cargo estiver ativo, exibirá uma mensagem pedindo
               se quer informar o nome
- MP-CE-NomeCarg-SELECT (CASE {CS-AtivCarg} WHEN 1 THEN 'Cargo Ativado!' ELSE '' END)
FROM DUAL
'Qualquer coisa'
  - Resultado: Quando o Cargo estiver ativo, exibirá uma mensagem 'Cargo Ativado!'
               senão, não exibirá nada (Só exibe se o Resultado <> '')
- FO-1010
  - Resultado: Vai chamar a tela cujo código é o 1010


BC - Executa o Botão Cancela
BO - Executa o Botão Confirma
CC - Campo Combo
CD - Campo Data
CE - Campo Editor
CM - Campo Memo
CN - Campo Número
CR - Campo Formatado
CS - Campo Sim/Não
CT - Campo Tabela
CA - Campo Arquivo
DG - Campo gravado no Cabeçalho
DM - Campo gravado no Movimento 1
D2 - Campo gravado no Movimento 2
D3 - Campo gravado no Movimento 3 (Primeira Tela)
DD - Campo gravado no Cabeçalho (Somente para enviar valor, não testa se é inclusão, sempre irá enviar)
DDM - Campo gravado no Movimento 1
DD2 - Campo gravado no Movimento 2
DD3 - Campo gravado no Movimento 3 (Primeira Tela)
EC - Editor Combo
ED - Editor Data
EE - Editor Editor
EN - Editor Número
ES - Editor Sim/Não
ET - Editor Memo (Texto)
EX - Executa
FF - Figura não ligada ao banco, busca a imagem no PDCAEmp
FI - Figura ligado ao Banco
FM - Chama o Formulário da Manutenção Genérica, permitindo passar filtro. Ex.: FM-90
     -(CodiPess <= 100)
FO - Chama Formulário
FDM - Chama o formulário sem dar um Insert... (ClicModAces). Ex.: FDM1010
FDC - Chama o formulário de manutenção com where ex.: FDC965    -PDCAFDAL.CODIPEDI = {DG-CODIPEDI} e também permite setar o DG após a chamada do formulário
FV - Executa após voltar do FO (Formulário) (Veja exemplo acima)
GC - Retorna a Coluna atual do Grid
GR - Gera Arquivo de Remessa de Boletos (Espera a Query e o Endereço). Ex.: GR-DadoReme-SELECT
     {EE-EndeReme} FROM DUAL -> (EndeReme teria o Endereço do Arquivo).
IE - Informação Editor
IF - Condição (INIC0001 é o início e executa se Resultado <> 0, e FINA0001 encerra)
IM - Imprime. Exemplo: IM-LPT1   -SELECT '{CE-NomCida}' FROM DUAL
IN - Informação Número
IR - Imprime Relatório: IR-21041   -(PDCA Pess.CodiPess = {DG-CodiPess})
   - "IR" no campo Mensagem do Relatório
   
- Ação (posição do troco): Por padrão é 2 (composto), mas existe a possibilidade de passar: 0 = Visualiza, 1 = Imprime, 2 = Composto, 3 impressão direta  e 4 Salva
QRP, quando usado a opção 4, o endereço salvo estará na {VA-STRI0008})
IT - Informação Tabela
LB - Label
LE - Cálculo Editor
LN - Cálculo Número
LC - Lista (CheckBox)
LCM - Marca itens da lista. Ex: LCMLISTXXX-WHERE CODIAUXI IN (1,2,3) (Irá passar o filtro para a query e marcar conforme o filtro)
MA - Mensagem de Alerta
MC - Mensagem com Confirma (Sim, Não)
ME - Mensagem de Erro
MI - Mensagem de Informação
MP - Mensagem de Informação Personalizada (Obrigatório as 2 linhas -> compatibilidade)
QD - Filtro para o Grid, retornando na Posição em que estava (Linha e Coluna)
     (Para passar filtro para o GRID do Movimento usa-se {QD-DMDX   -AND...} o X representa qual é o movimento (1,2,3) e após são 4 espaços)
QM - Filtro retornando na posição em que estava (Linha)
QT - Query Tela
QY - Filtro ou Campo ligado
VV-12345678-'/Doc.=98.343.887-82/Tipo=3/UF=PR' -> Válida Documentos /Tipo: 0-docCPF, 1-docCNPJ, 2-docUF, 3-docInscEst, 4-
docNumCheque, 5-docPIS, 6-docCEP, 7-docCartaoCredito

QY-CodiPess-Abre -> Abre a Query
QY-CodiPess-Prim - Vai para o Primeiro Registro
QY-CodiPess-Prox - Vai para o Próximo Registro
QY-CodiPess-Ante - Vai para o Anterior Registro
QY-CodiPess-Ulti - Vai para o Último Registro
PA-A1230123-SELECT 1 FROM DUAL - Se encontrar Zero, não executa as demais instruções
abaixo.
BT - Botão (Somente utilizado para Habilitar/Desabilitar e Visível/Invisível)

GG-GRAFCRIA-SELECT 'Mortalidade: '||NomeLote FROM MPCaLote WHERE (NumLote = {VA-Inte0002})
GG-SERIORDE-10
GG-SERISERI-1 (0-Linhas; 1-Barras; 2-Barras Horizontais; 3-Área; 4-Pontos; 5-Pizza; 6-Linha
Rápida; 7-Shape; 8-Gantt; 9-Setas; 10-Bolhas)
GG-SERISQL_-SELECT NumLote AS ValorY, IdadCole AS ValorX, IdadCole AS NomeX FROM MPCaCole
WHERE (CodILote = {VA-Inte0003})
GG-SERICRIA-'Mortalidade'

GG-GRAFEXIB-

--> Gera PDCaData, as datas devem ter o formato DD/MM/YYYY
GD-12345678-SELECT '//DataInic=01/01/2000//DataFina=31/12/2020' FROM DUAL

Foi criado a opção de fechar quando confirma, para telas que só deveriam ser chamadas uma vez (por exemplo, o Contas a Pagar na nota de Entrada).
Fecha
VA-FECHCONF-1
Não Fecha
VA-FECHCONF-0
Pegar o valor
{VA-FECHCONF}

-- LOOP
WH-NOVOMOV01-SELECT IDADIDAD FROM PDCAIDAD WHERE (TRUNC(IDADIDAD) = IDADIDAD) AND (IDADIDAD BETWEEN 1 AND 3) ORDER BY IDADIDAD

MP-DG-12345678-SELECT {QY-NOVOMOV01-IDADIDAD}||' idade' FROM DUAL


Idade
WH-NOV0001-
-- FIM DO LOOP

------------------ R E S U L T A D O S ------------------
{VA-INSERIND} - Retorna 1 para inserindo, 0 para alterando (Somente Retorna)

{QY-CodiPess-NumeRegi} - Retorno o número de Registros dessa Query (Somente Retorna)

{GC-GridPess} - Retorna a Coluna do Grid onde o cursor esta localizado.

{LC-ABCD1234-NUMETOTA} - Retorna o número de itens na Lista
{LC-ABCD1234-NUMESELE} - Retorna o número de itens selecionados na Lista
{LC-ABCD1234-NUMENAOS} - Retorna o número de itens não selecionados na Lista

{CT-CODIAUXI-PROCTUDO} - Executa os comandos do Executa na Saída do campo CODIAUXI

------------------ EXECUTAS PERSONALISADOS ------------------

Campo Executa na Saída:
QY-CODIPESS-AND CODIPESS = COPY(RETOPUSU(USER),2,2)
[PERS-AGD-01]
CT-CODICENT-SELECT NULO({QY-CODIREQU-CODICENT}) FROM PDCAAUXI
[PERS-AGD-02]
CT-CODIPLAN-SELECT NULO({QY-CODIREQU-CODIPLAN}) FROM PDCAAUXI


Campo Personalizado:
[PERS-AGD-01]
QY-CODIPESS-AND CODIPESS = COPY(RETOPUSU(USER),5,2)

[PERS-AGD-02]
CT-CODIPLAN-SELECT NULL FROM PDCAAUXI
--------------------------------------------------------------------------------

Endereço de Arquivo

Descrição: Variaveis que podem ser utilizadas em endereço de arquivo

$EndeExec$: Endereço do .exe

$YY$: Ano com dois digitos

$YYYY$: Ano com quatro digitos

$MM$: Mês numeral

$MMM$: Mês alfa

$DD$: dia

$HH$: hora

$NN$: segundo

$CODIEMPR$

$PEMP$

$PCODEMPR$

$CNPJEMPR$

--------------------------------------------------------------------------------

IR

Descrição: Imprime Relatório: IR-21041 -(PDCaPess.CodiPess = {DG-CodiPess})

▪ "IR" no campo Mensagem do Relatório

4.0.36.677 - Executa na Saída: Alterado o comando IR, agora podesse enviar o SELECT e FROM também, por exemplo: IR-12345678-SELECT
CODIPESS, NOMEPESS FROM PDCAPESS WHERE (CODIPESS = {CT-CODIPESS}). Ou seja, pode mudar o SQL do relatório pelo Executa na
Saída.


6.0.20.223 - Ação (posição do traço): Por padrão é 2 (composto), mas existe a possibilidade de passar: 0 = Visualiza, 1 = Imprime, 2 = Composto
e 4 Salva QRP, quando usado a opção 4, o endereço salvo estará na {VA-STRIO008})

6.0.22.246 - Ação (posição do traço): Agora tem a opção 5, que poderá ser enviado o endereço e tipo do relatório a ser salvo, não pedindo a tela
de "Salvar". Essas configurações devem estar no {VA-STRIO007}. Exemplo:

  ▪ VA-STRI0007-SELECT '/EndeArqu=C:\SAG\Relatórios\Pedido-{DG-NUMEPED}].pdf /TipoRela=4' FROM PDCAAUXI
  ▪ IR512345678-(PDCaPess.CodiPess = {DG-CodiPess})

No endereço do arquivo, é possível usar a variável $EndeExec$, que trará o path do .exe. Exemplo:

  ▪ VA-STRI0007-SELECT '/EndeArqu=$EndeExec$\Relatórios\Pedido-{DG-NUMEPED}].pdf /TipoRela=4' FROM PDCAAUXI
  ▪ IR512345678-(PDCaPess.CodiPess = {DG-CodiPess})

Tipos de Arquivos:

----------------------------------------------------------
'PDF (*.pdf)|*.pdf'+                                //01
'|PDF Compacto (*.pdf)|*.pdf'+                      //02
'|PDF Imagem (*.pdf)|*.pdf'+                        //03
'|PDF Imagem Compacto (*.pdf)|*.pdf'+               //04
'|Quick Report (*.qrp)|*.qrp'+                      //05
'|Texto (*.txt)|*.txt'+                             //06
'|Página Web (*.html|*.html'+                       //07
'|CSV (Separado por vírgula) (*.csv)|*.csv'+        //08
'|MSExcel (*.xls)|*.xls'+                           //09
'|Rich Text Formato (*.rtf)|*.rtf'+                 //10
'|XML (*.xml)|*.xml'+                               //11
'|Imagem JPG (*.jpg)|*.jpg'+                        //12
'|Imagem BMP (*.bmp)|*.bmp'+                        //13
'|Imagem WMF (*.wmf)|*.wmf'+                        //14
'|Imagem EMF (*.emf)|*.emf'                         //15

VA

Descrição: Variáveis

■ VA-INSERIND - Retorno - Retorna 1 para inserindo, 0 para alterando
■ VA-RETOFUNC - Retorno - Apenas para retorno de Funções (do tipo String).
■ VA-CONFIRMA - Retorna e Recebe. Se está variável tirar um valor, ao confirmar será exibido uma mensagem de erro com seu conteúdo.
■ VA-RESU0001 - Retorno 0001 até 0008 String - Variável de Resultado, que será usado para retorno de funções do Delphi, para evitar de usar uma outra VA e o Delphi substituir.
■ VA-DATA0001 - Variável 0001 até 0010 Data (Retorna e Recebe)
■ VA-INTE0001 - Variável 0001 até 0010 Inteira (Retorna e Recebe)
■ VA-REAL0001 - Variável 0001 até 0010 Real (Retorna e Recebe)
■ VA-STRI0001 - Variável 0001 até 0010 String (Retorna e Recebe)
■ VA-VALO0001 - Variável 0001 até 0010 String (Retorna e Recebe), porém retorna sem as ASPAS de uma string.

----------------------------------------------------------------------------------------------------
Para todas as VA tem de 11 a 20 também, porém estas são "Públicas" e o uso da mesma deverá
ser documentado no POCATabe da mesma, para que o próximo a utilizar saiba.
----------------------------------------------------------------------------------------------------

■ VA-CODIPESS - Retorna o Código do Usuário (CodiPess)
■ VA-PCODPESS - Retorna o PCODPESS do Usuário
■ VA-EMPRESA - Retorna a sigla da empresa (SAG, AGD, ADO, AMZ, VIT...)
■ VA-NUMEBASE - Número da BAse (2=SQLServer, 3=Firebird ou 4=Oracle)
■ VA-CODITABE - Retorna o CodiTabe da tela atual (por exemplo, no cadastro de empresa, retornará 10)
■ VA-CODISIST - Retorna o número do Módulo (exemplo, matrizes, retornará 1)
■ VA-NOMESIST - Retorna o nome do sistema/módulo
■ VA-PDA1MANU - Primeira data da manutenção genérica, quando utilizado o GETDATE() como campo (Filtros)
■ VA-PDA2MANU - Segunda data da manutenção genérica, quando utilizado o GETDATE() como campo (Filtros)
■ VA-FECHCONF - Retorna se o botão Fecha esta visivel (1)

6.1.35.201 - 05/11/2015 - Sidiney

■ VA-USUAMONI - Retorna o usuário do Banco de Dados (RetoUserBase())

■ VA-VERSMONI - Retorna a versão do aplicativo (RetoVers())
■ VA-IP__MONI - Retorna o IP da Máquina (PegaIP())
■ VA-MAQUMONI - Retorna o nome da Máquina do Windows (PegaMaqu())
■ VA-WINDMONI - Retorna o nome do usuário do Windows (PegaUsuaWind())
■ VA-ENDEMONI - Retorna o endereço do .exe (Application.ExeName)

6.1.41.021 - 28/06/2016 - Mauricio

■ VA-DATETIME - Retorna a data e hora em formato: 'DD/MM/YYYY HH:MM:SS'
■ VA-DATE - Retorna a data no formato: 'DD/MM/YYYY'
■ VA-TIME - Retorna a data no formato: 'HH:MM:SS'

PU

Estas variáveis são como as VA porém podem ser utilizadas para receber os dados de uma tela que foi chamada por FO, como por exemplo o código:

■ PU-DATA0001 - Variável 0001 até 0010 Data (Retorna e Recebe)
■ PU-INTE0001 - Variável 0001 até 0010 Inteira (Retorna e Recebe)
■ PU-REAL0001 - Variável 0001 até 0010 Real (Retorna e Recebe)
■ PU-STRI0001 - Variável 0001 até 0010 String (Retorna e Recebe)
■ PU-VALO0001 - Variável 0001 até 0010 String (Retorna e Recebe), porém retorna sem as ASPAS de uma string.

Exemplo:

--------------------------------------------------------------------------------
FO-25040
PU-INTE0001-{DG-CODIFINA}
--------------------------------------------------------------------------------

Som

SO

Descrição: Som (beeps conforme o número passado).

--------------------------------------------------------------------------------
SO-12345678-5
--------------------------------------------------------------------------------


S3

Descrição: Som MP3 (executa o arquivo passado durante o tempo no campo). Poderá utilizar a variável $EndeExec$ para pegar o endereço do .exe (Exemplo: $EndeExec$\MP3\ERROCARR.MP3).

--------------------------------------------------------------------------------
S3-5   -C:\SAG\MP3\ERROCARR.MP3
--------------------------------------------------------------------------------


QUERY´S

QN

Descrição: Cria uma query com o SQL passado.

--------------------------------------------------------------------------------
QN-BUSCVALO-SELECT 1 AS VALO, 2 AS DOIS FROM DUAL
MP-DG-12345678-SELECT {QY-BUSCVALO-VALO}+{QY-BUSCVALO-DOIS} AS VALO FROM DUAL
QN-BUSCVALO-DESTROI
--------------------------------------------------------------------------------

A opção "DESTROI" é opcional, ao fechar a tela, o componente será destruído, e se não for pelo comando, poderá ser utilizado em outros locais.

--------------------------------------------------------------------------------

Mensagem

ME

Descrição: Mensagem de Erro (executa beeps conforme o número passado na Ação).

--------------------------------------------------------------------------------
ME5DG-CODIPESS-0
Erro na Pessoa!
--------------------------------------------------------------------------------


MB

Descrição: Igual ao ME (http://192.168.0.100:90/wiki/index.php?title=Versao6#ME), porém sem o botão OK (para telas de carregamento).

--------------------------------------------------------------------------------
MB5DG-CODIPESS-0
Erro na etiqueta!
--------------------------------------------------------------------------------


Campo Editor

CA

Descrição: Campo para nome de Arquivo (Campo gravado).

--------------------------------------------------------------------------------

Editor

EA

Descrição: Editor para nome de Arquivo.

--------------------------------------------------------------------------------


GRID

Ordenar

Para ordenar no novo grid, basta clicar sobre a coluna desejada, que ordenará de forma crescente e clicando novamente, ficará em ordem decrescente. Para fazer múltiplas ordens, utilize a tecla SHIFT, por exemplo, Ordenar por UF e depois por Cidade, ordene por UF, mantenha a tecla Shift pressionada e clique na Cidade. Para tirar uma ordem, utilize a tecla CTRL e clique na coluna. (by Sidiney)

Configurações

[Colunas]
Valor=/TotaGrup=S/TotaRoda=S/Masc=#,###,##0.00/Edit=N/Tama=0/Visi=S/Nome=
Qtde=/TotaGrup=S/TotaRoda=S/Masc=#,###,##0.00/Edit=N/Tama=0/Visi=S/Nome=
Unitaria=/TotaGrup=S/TotaRoda=S/Masc=#,###,##0.00/Edit=N/Tama=0/Visi=S/Nome=

Busca Incremental: em uma célula da coluna, comece a digitar um valor, que será feito uma busca incremental

Filtro na Coluna

Ordem pela Coluna

Aqui está a transcrição literal do conteúdo da imagem, utilizando traços para simular as linhas e blocos, conforme solicitado:


Para ordenar no novo grid, basta clicar sobre a coluna desejada, que ordenará de forma crescente e clicando novamente, ficará em ordem decrescente. Para fazer múltiplas ordens, utilize a tecla SHIFT, por exemplo, Ordenar por UF e depois por Cidade, ordene por UF, mantenha a tecla Shift pressionada e clique na Cidade. Para tirar uma ordem, utilize a tecla CTRL e clique na coluna

Arrastar o título para fazer grupos

Configurar Colunas: Na opção 'Exibe SQL', um alias de uma coluna, por exemplo MPCaloTe.MachLote AS Machos, selecione o Machos e clique no botão direito, 'Configura Coluna', aparecerá a lista de opções, sendo que será montado uma linha na guia '5-Configurações' (Machos=$/TotaGrup=$/TotaRoda=$/Masc=\#,\#\#\#.\#\#\#o/Edit=N/Tama=o/Visi=S/Nome=). A opção TotaGrup e TotaRoda permite combinação dos cálculos, ou seja, pode colocar SIX (S=Soma, I=Mínimo, X=Máximo, M=Média, C=Contar) Fórmulas: Junto a opção máscara (/\Masc) é possível informar uma fórmula, por exemplo: "% Machos=$/TotaGrup=$/TotaRoda=$/Masc=%\#\#\#\#.\#\#oo {<Machos> / <Fêmeas> \* 100}/Edit=N/Tama=o/Visi=S/Nome=". O que estiver entre os {} será a fórmula e será apagado da máscara. O campos ficam entre $<>$ porque a estrutura da configuração usa o [] como indicador de sessão (formato ini). Porém, os campos usados nas fórmulas devem estar nos totais, que é o caso acima, as Fêmeas e os Machos estão totalizados e quando usar "/", sempre lembrar de dar um espaço após, para não ser confundida com um marcador (/\Masc, /Nome...).

Uso no PLSAG

Os GRID podem receber variáveis

EXEMPLO DE SQL:

----------------------------------------------------------------------------------------------------------------------------------------------------
'VA-VALOR001-'TESTE''
SELECT '[VA-VALOR001]' AS VALO FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

COMANDO PARA EXECUTAR E SUBSTITUIR A VARIÁVEL

----------------------------------------------------------------------------------------------------------------------------------------------------
QD-GRIDGRID-WHERE 1=1
----------------------------------------------------------------------------------------------------------------------------------------------------

O RESULTADO SERÁ UMA COLUNA COM O NOME VALO E VALOR TESTE

COMANDO ABAIXO NÃO FUNCIONA NA SUBSTITUIÇÃO DA VARIÁVEL

----------------------------------------------------------------------------------------------------------------------------------------------------
QD-GRIDGRID-ABRE
----------------------------------------------------------------------------------------------------------------------------------------------------

Sua aplicação acima é basicamente para exemplo, mas as variáveis podem ser usadas no where das consultas.


----------------------------------------------------------------------------------------------------------------------------------------------------

EP

Descrição: Executa Procedures do Proc.Pas, conforme o nome passado e retorna o resultado da execução no {VA-RETOFUNC}, sendo 1 para ok e
o para falha.

----------------------------------------------------------------------------------------------------------------------------------------------------
Procedure padrão de exemplo
NOMEPROC
Exemplo de chamada para EP
EP-NOMEPROC-SELECT * FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

TR

Descrição: Executa Trigger feitas no Delphi, para chamada nos finais de processos

----------------------------------------------------------------------------------------------------------------------------------------------------

POCAESTO

6.0.24.322: Atualiza os campos do POCaMvEs baseado nas informações da POCaEsto e atualiza os campos totalizadores da POCaEsto baseado
na POCaMvEs. Também gera a POCaMvCx baseado no dados da POCaMvEs (CodiPlan e CodiCent). Exemplo abaixo, onde 123456 é o CodiEsto.

----------------------------------------------------------------------------------------------------------------------------------------------------
TR-POCAESTO-123456
----------------------------------------------------------------------------------------------------------------------------------------------------

EX

Descrição: Executa SQL

----------------------------------------------------------------------------------------------------------------------------------------------------

APAGINDU

6.0.24.260: Apaga o processo de industrialização, conforme exemplo abaixo (faz loop para a deleção):

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-APAGINDU-SELECT CODIESTO AS CODIINDU, (DG-CODIORCA) AS CODIGENE, 'RACACRCA' AS TABEINDU FROM POGEESTO WHERE (TABEESTO = 'RACACRCA') AND (CODIGENE = (DG-CODIORCA))
----------------------------------------------------------------------------------------------------------------------------------------------------

GERAINDU

6.0.24.260: Gera o processo de industrialização conforme o SQL passado, sendo que os campos do exemplo são obrigatório. O Chamada retorna
o resultado na {VA-RESU0001} sendo 1 para Ok e o para não concluído. Segue abaixo exemplo completo:

----------------------------------------------------------------------------------------------------------------------------------------------------
IF-INICI0001-SELECT (CASE (DG-SITUORCA) WHEN 'L' THEN 1 ELSE 0 END) FROM DUAL
EX-GERAINDU-SELECT CODIPROD AS CODI PROD, (DG-RECEORCA) AS DATA, QTDDEVOC AS QtdeReal, QTDENVOC AS QtdePrev, 'Industrialização da Ordem' AS Composto, CODI CENT AS
CodiCent, 'RACACRCA' AS TabEsto, (DG-CODIORCA) AS CodiGene FROM RACAMVOC WHERE (CODIORCA = {DG-CODIORCA})

ME-DG-CODIORCA-{VA-RESUMB001}
Industrialização não Concluída!
IF-FINA0001
----------------------------------------------------------------------------------------------------------------------------------------------------

POCADATA

6.0.24.260: Gera a tabela POCaData, executa o mesmo processo que tem no Sistema/Suporte/Processo/Gera Data (POCaData):

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-POCADATA-SELECT '01/01/2018' AS DataInic, '31/12/2018' AS DataFina FROM POCaAuxi
----------------------------------------------------------------------------------------------------------------------------------------------------

EXPOTEXT

6.0.25.329: Gera arquivo texto baseado nas tabelas POCaExTe e POCaMvET. Recebe o SQL com o Tipo (campo obrigatório) e com os
parâmetros:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-EXPOTEXT-SELECT 'DCTF' AS Tipo, '01/01/2018' AS DataInic, '31/12/2018' AS DataFina FROM POCaAuxi
----------------------------------------------------------------------------------------------------------------------------------------------------

Caso queira passar o nome do arquivo, utilizar (opcional):

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-EXPOTEXT-SELECT 'DCTF' AS Tipo, '01/01/2018' AS DataInic, '31/12/2018' AS DataFina, 'C:\SAG\Teste.txt' as EndeArqu FROM POCaAuxi
----------------------------------------------------------------------------------------------------------------------------------------------------

Lembrando que o filtro pode ser qualquer campo, que será procurado por :NomeCampo: no SQL gravado nas tabelas acima (POCaExTe e
POCaMvET). Exemplo:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-EXPOTEXT-SELECT 'DCTF' AS Tipo, 1012 AS CodiPedi, '01/01/2018' AS DataInic, '31/12/2018' AS DataFina, 'C:\SAG\Teste.txt' as EndeArqu FROM POCaAuxi
----------------------------------------------------------------------------------------------------------------------------------------------------

ARQUIZIPA

6.0.25.356: Zipa o arquivo passado, retornando o nome do arquivo compactado na {VA-RETOFUNC}:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-ARQUIZIPA-C:\SAG\Teste.txt
----------------------------------------------------------------------------------------------------------------------------------------------------

COPIREGI

6.0.38.501: Duplica o registro que está sendo inserido. Recebe 5 campos obrigatórios, sendo eles: Copi_OrigTabel-nome da tabela de origem do
registro; Copi_DestTabel-nome da tabela de destino, para onde irá o registro duplicado (geralmente o mesmo da origem); Copi_CampChav-
nome do campo que receberá o valor do campo chave, geralmente é o código principal da tabela (Ex: CodiPess); Copi_ValoChav-valor do campo
chave atual (Ex: valor do CodiPess atual- (DG-CODIPESS)); Copi_CampInic - a partir de qual registro irá duplicar, lembrando que como o
Delphi começa inicializa a contagem do 0, o registro 1 será o 2o (Ex: '1' AS "Copi_CampInic", se a tabela for POCAPESS e os dois primeiros
campos CODIPESS e NOMEPESS respectivamente, ele começará duplicar a partir do NOMEPESS). O restante dos campos passados devem
corresponder aos campos que serão diferentes (Ex: na origem o TABEPESS é 'PESSOA', mas no destino é necessário que ele seja
'COPIA_PESSOA', para isso deve-se passar 'COPIA_PESSOA' AS TABEPESS e ele será substituído). É possível também fazer a cópia de registros
de tabelas de movimento, para isso deve-se substituir o FROM POCAAUXI para FROM TABEMV... e feito um WHERE com o código da tabela de
cabeçalho.

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-COPIREGI-SELECT 'TabelaOrigem' AS "Copi_OrigTabela", 'TabelaOrigem' AS "Copi_DestTabela", 'coditabela' AS "Copi_CampChav",
DG-CODiTabela] AS "Copi_ValoChav", 1 AS "Copi_CampInic", 'CampoDiferente' AS "NomeCampo" FROM POCAAUXI
----------------------------------------------------------------------------------------------------------------------------------------------------

VDCHMAPA

6.1.13.192: Exibir o mapa dos endereços passados. O primeiro campo da consulta que será passado para o Google Maps. Os demais são apenas
para exibir para o usuário. Este exemplo é um botão que está como exemplo na tela de Cargas (Mod 2).

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-VDCHMAPA-SELECT DISTINCT NomeCida||'', '||UF_Cida AS "Ende", NomeCida AS "Cidade", UF_Cida AS "UF", ENDERVEN AS "Endereco",
CEP_MVEn AS "CEP", NomeCida||'', '||UF_Cida AS "Endereço Completo"
FROM VOCAMVCA INNER JOIN VOCAPEDI ON VOCAMVCA.CODIPEDI = VOCAPEDI.CODIPEDI INNER JOIN POCAMVEN ON VOCAPEDI.CODIPESS = POCAMVEN.CODIPESS
INNER JOIN POCACIDA ON POCAMVEN.CODI_CIDA = POCACIDA.CODICIDA
WHERE (VOCAMVCA.CODICARG = {DG-CODICARG}) AND (TIPOAPEN IN ('ENT', 'PRIN'))
----------------------------------------------------------------------------------------------------------------------------------------------------

SENHLIBE

6.1.23.162: Solicitação de liberação para Bloqueios. Será através da tabela POCALibe que terá os campos do solicitante, opção da solicitação,
valor e limite. Poderá ser autorizado diretamente na tela de solicitação ou através de tela de Autorização, disponível em Gerência/Autorização
(Limites) ou Gerência/Autorização (Limites) (Diretoria). Para o chamado da tela de Autorização, utilizar a instrução, conforme exemplo abaixo:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-SENHLIBE-SELECT 10 AS CODiTABE, 0 AS CODiPESS, 'Limite para Cadastro de Empresas' AS DescLibe
, 10 AS ValoLibe, 9 AS LimiLibe, 'P' AS SituLibe, 20 AS CodiGene, 'POCAEMPR' AS Tabelibe FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

A situação (SituLibe) poderá ser P de pendente e D de Diretoria. A resposta será L de Liberado ou C de Cancelado. Caso venha diferente de L,
sairá do Executa, como se fosse um ME. Mesmo assim, o resultado estará na {VA-RETOFUNC}.

DISTMVCX

6.1.23.322: Distribuição dos valores na tabela POCaMvCx (principalmente Plano de Contas e Centro de Custo). Exemplo abaixo:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-DISTMVCX-SELECT (VA-CODiTABE) AS CodiTABE, POCaMvEs.CODiMVES AS CodiMVES, POCaEsto.CodiPESS, POCaEsto.CodiTpNv, POCaEsto.CodiEsto,
POCaEsto.CodiTran, POCaProd.CodiPlan, 0 AS CodiCent, EmiEsto AS EmiS, ReceEsto AS Rece, 0 AS PermCanc
FROM POCAMVES inner join POGEESTO on pocamves.codiesto = pocæesto.codiesto
Inner join POGEPROD on pocamves.codiprod = pocaprod.codiprod WHERE CODIMVES = 5206
----------------------------------------------------------------------------------------------------------------------------------------------------

No caso acima, foi filtrado pelo CodiMvEs, mas pode ser filtrado também pelo CodiEsto ou outro filtro, mas para cada registro será aberto a tela
para fazer o rateio.

O campo PermCanc é se permite o cancelamento, no caso de alteração, quando inclusão, não deve permitir, senão o usuário poderá deixar de
fazer o rateio.

Vale lembrar que no processo de gravação, os dados da POGEEsto ainda não estarão gravados, portanto, utilizar as variáveis de tela para enviar
para chamada, por exemplo: {CD-RECEESTO}, {CD-EMISESTO}...

CALCCODI

6.1.23.323: Calcular o código do campo e tabela passada. Exemplo abaixo:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-CALCCODI-SELECT 'POCAMVES' AS Tabe, 'CODIMVES' AS Camp FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

MUDADTB

6.1.23.300: Mudar o Database devido as Transações

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-MUDADTB-'_DTBCADA'
EX-MUDADTB-'_DTBGENE'
----------------------------------------------------------------------------------------------------------------------------------------------------

EXISARQU

6.1.23.000: Verifica se o arquivo existe no diretório passado.

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-EXISARQU-Local do arquivo.
----------------------------------------------------------------------------------------------------------------------------------------------------

Exemplo:
EX-EXISARQU-'C:\TEXTO.TXT' OU EX-EXISARQU-{VA-STRI0001} (Caso use uma variável para concatenar o diretório).

Após isso, utilizar a {VA-RETOFUNC} para verificar o retorno, '1' existe, '0' não existe.

CUSTPROD

6.1.41.910: Calcular o custo do produto pelo exe

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-CUSTPROD-SELECT 8613 AS CODiPROD, GETDATE() AS DATA FROM DUAL
MP-EX-12345678-{VA-RESUMBOO1}
----------------------------------------------------------------------------------------------------------------------------------------------------

OPERARQU

Executas na Saída - ShellExecute

Foi realizada uma alteração no comando OPERARQU (Versão 6.1.17.288), onde passa um parâmetro (opcional no sql).

Pode ser executada da seguinte maneira:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-OPERARQU-SELECT 'open' AS Operacao, 'C:\Program Files (x86)\Google\Chrome\Application\chrome.exe' AS Endereco, 'https://ibpf.sicredi.com.br/ib-
view/presblindagemIBPFsarSalw.html?coop=0000&conta=000000' as Parametro, 0 as Tipo FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

Este comando acima irá abrir uma página WEB utilizando o Chrome diretamente no site do Sicredi para login na conta

Existem vários tipos para o ShellExecute, segue abaixo uma lista com eles

Tipos:
SW_HIDE = 0;
SW_SHOWNORMAL = 1;
SW_SHOWMINIMIZED = 2;
SW_SHOWMAXIMIZED = 3;
SW_MAXIMIZE = 3;
SW_SHOWNOACTIVATE = 4;
SW_SHOW = 5;
SW_MINIMIZE = 6;
SW_SHOWMINNOACTIVE = 7;
SW_SHOWNA = 8;
SW_RESTORE = 9;
SW_SHOWDEFAULT = 10;
SW_MAX = 10;

Impressão de Arquivos:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-OPERARQU-SELECT 'Print' AS Operacao,
'c:\temp\texto.pdf' AS Endereco, 0 AS Tipo FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

Por exemplo, caso tenha um bat com o comando: "C:\Program Files (x86)\Adobe\Reader 10.0\Reader"\acrord32 /t %1

Deve ser Executado pelo OPERARQU:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-OPERARQU-SELECT 'open' AS Operacao, 'C:\temp\imprimepdf.bat' AS Endereco, 0 AS Tipo, 'c:\temp\texto.pdf' as Parametro FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

Caso apareça a mensagem: "O Adobe Reader não pode ser aberto no Modo Protegido devido a um problema com a configuração do sistema.
Deseja abrir o Adobe Reader com o Modo Protegido desativado?"

O que deve ser feito: Abrir o Adobe Reader, ir em Editar> Preferências> Geral e cancelar a seleção "Ativar o Modo Protegido na inicialização", ou
em alguns casos "Permitir modo protegido na inicialização".

LISTAGRU

6.1.42.000: Gera uma lista de valores separados por ,

Lista de fornecedores:
----------------------------------------------------------------------------------------------------------------------------------------------------
EX-LISTAGRU-SELECT CODIPESS AS LISTA FROM POGEPESS WHERE FORNPESS = 1
Parâmetro lista é obrigatório!
MP-EX-12345678-{VA-RESU0001}
----------------------------------------------------------------------------------------------------------------------------------------------------

VALIHORA

6.1.43.380: Valida se a string é data e retorna 1 para verdadeiro e 0 para falso

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-VALIHORA-{EE-HOINFOR}
ME-EE-HOINFOR-{VA-RESU0001}
Hora inválida
----------------------------------------------------------------------------------------------------------------------------------------------------

VALIDATA

6.1.43.380: Valida se a string é data e retorna 1 para verdadeiro e 0 para falso

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-VALIDATA-{EE-INFOR}
ME-EE-INFOR-{VA-RESU0001}
Data inválida
----------------------------------------------------------------------------------------------------------------------------------------------------

POCHGRID

6.1.41.960: Abre uma tela com um GRID. Segue abaixo exemplo completo:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-POCHGRID-SELECT NOMEPAPROD AS "Produto" FROM POGEPROD
----------------------------------------------------------------------------------------------------------------------------------------------------

6.1.46.580: Adicionadas as seguinte configurações:

AutoAjuste: Quando passado 1 para a coluna AutoAjuste as colunas são redimensionadas automaticamente para melhor visualização Alterar: Ao
nomear uma coluna com Alterar é possível modificar os dados da coluna Coluna: Quando uma coluna é nomeada desta forma ela é utilizada para
informar qual a coluna ser alterada na que foi nomeada com "Alterar"

----------------------------------------------------------------------------------------------------------------------------------------------------
[Colunas]
AutoAjuste=/Visi=N
Alterar=/Edit=S
Coluna=/Tama=100
----------------------------------------------------------------------------------------------------------------------------------------------------

Exemplo:

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-POCHGRID-SELECT CODIMVOC AS "Código", ' ' AS "Coluna", ORDEMVOC AS "Alterar" FROM RACAMVOC WHERE CODIMVOC IN (LC-LISTMVOC)
----------------------------------------------------------------------------------------------------------------------------------------------------

ADT_XML_

6.1.66.623: Importar ADT's/XML para uma tabela podendo utilizar um campo chave. Com três opções de importação:

Foi adicionado uma opção em Utilitários/Importa Arquivo (ADT/XML) que utiliza as funções abaixo para importar arquivos padrões necessários
(principalmente o Fiscal) (CodiTabe = 9300) (Chamado: 115.947)

Parâmetros gerais: CampChav: É o campo que será buscado o registro no destino. Quando não informado, será DELETADO tudo da tabela e dado
INSERT com os dados do ADT

ARQU

Quando o campo Tipo = ARQU, no campo EndeArqu deverá vir o endereço completo para a importação do Arquivo (pode ser utilizado as
variáveis de endereço de arquivo: http://192.168.0.1:90/wiki/index.php?title=Versao6\#Endere.C3.A7o\_de\_Arquivo)

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-ADT\_XML\_-SELECT 'ARQU' AS Tipo, 'C:\SAG\ADT\FSGENCMB.ADT' as EndeArqu, 'FSCANCMB' AS Tabe, 'SAG\_NCMB' AS CampChav FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

ABRE

Quando o campo Tipo = ABRE será pedido qual o arquivo que deseja importar (Dire é opcional e pode ser utilizado as variáveis de endereço
padrões do SAG: http://192.168.0.1:90/wiki/index.php?title=Versao6\#Endere.C3.A7o\_de\_Arquivo)

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-ADT\_XML\_-SELECT 'ABRE' AS Tipo, 'C:\SAG\ADT\' AS Dire, 'FSCANCMB' AS Tabe, 'SAG\_NCMB' AS CampChav FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

REMO

Quando o campo Tipo = REMO irá buscar a tabela a ser importada no servidor da SAG. Sempre utilizará o campo chave como sendo SAG\_XXXX
(onde XXXX é o sobrenome da tabela). Também fará o update do CodiXXXX para o SAG\_XXXX antes da importação na tabela remota.

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-ADT\_XML\_-SELECT 'REMO' AS Tipo, 'FSCANCMB' AS Tabe, 'WHERE CODIINCMB < 18638' AS When FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

MANUDADO

6.1.66.882: Opção de manutenção de dados, executando as triggers do Delphi. Necessário informar a opção na Stri0011, podendo ser 'QY', 'DS'
ou o nome da tabela. Para os campos de buscas/chave, informar a palavra CHAV\_ antes do nome do campo.

----------------------------------------------------------------------------------------------------------------------------------------------------
VA-STRI0011-'FCCAAPAN'
EX-MANUDADO-SELECT 10 AS CHAV\_CODILOTE, 0 AS AVESAPAN, 100 AS PESOAPAN FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------------------------------------------------------------
QU-GERAAPAN-SELECT 10 AS CHAV\_CODILOTE, 0 AS AVESAPAN, 100 AS PESOAPAN FROM DUAL
VA-STRI0011-'QY'
EX-MANUDADO-'QYGERAAPAN'
----------------------------------------------------------------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------------------------------------------------------------
VA-STRI0011-'DS'
EX-MANUDADO-'DTSGRAV'
----------------------------------------------------------------------------------------------------------------------------------------------------

IMPOARQU

6.1.66.671: Importar arquivos, enviando para uma tabela para posterior importação

Parâmetros:

Tabe: Nome da tabela

Camp: Nome do campo que receberá cada linha do arquivo

Opcional:

Fix1: Informa o nome do campo para enviar um valor fixo (Val1)

Val1: Valor para o campo Fix1

Fix2: Informa o nome do campo para enviar um valor fixo (Val2)

Val2: Valor para o campo Fix2

Permite o processo de importação por Arquivo ou a Pasta, se enviar valor para o campo DIRE, fará a importação da Pasta toda (obrigatório enviar
o campo EXTE), assim:

Por Arquivo, enviar:

Arqu: Endereço completo do Arquivo

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-IMPOARQU-SELECT '$\EndeExec$\Importa.txt' AS Arqu, 'CACARELO' AS Tabe, 'LINHRELO' AS Camp, 'NUMERELO' AS FIX1, (EN-NUMERELO) AS VAL1, 'TPARRELO' AS FIX2, (EX-TPARRELO)
AS VAL2 FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

Por Pasta, enviar:

Dire: Pasta para ser importada

Exte: Extensão dos arquivos para serem importados

----------------------------------------------------------------------------------------------------------------------------------------------------
EX-IMPOARQU-SELECT '$\EndeExec$\Importa\' AS Dire, '*.txt' AS Exte, 'CACARELO' AS Tabe, 'LINHRELO' AS Camp, 'NUMERELO' AS FIX1, (EN-NUMERELO) AS VAL1, 'TPARRELO' AS FIX2,
(EX-TPARRELO) AS VAL2 FROM DUAL
----------------------------------------------------------------------------------------------------------------------------------------------------

NF

Descrição: Nota Fiscal Eletrônica

1. Gera XML: Através da chamada NFe com o código da consulta que tenha a estrutura do XML e um WHERE para esta consulta, por exemplo: NFG230010001-AND (CODINOTA IN
(LC-NOTAAUXI))
	a. Se na consulta tiver o CertificadoDigital, as NFe's geradas serão assinadas
	b. Se na consulta tiver o CodiLote, as NFe's são agrupadas num lote, sendo que após este passo este lote será transmitido para o Web Service (WS), usando a
UF30\_NFe\_enviaLoteNF\_UF e o TipoEnvio\_LoteNFe
2. Assina XML: Através da chamada NFe, passando os parâmetros: Exemplo: 'NFA12345678-/(CertDigital)={EE-CERTIAUXI}/TipoAssin=0/(CodiNota=(VA-INTE0001))
	a. /Endereço: Endereço do Arquivo a ser Assinado (se o não for passado, será buscado de: C:\SAG\NFe\123456-nfe.xml, onde 123456 é o código da nota, o nfe poderá
ser canc ou Inu, conforme o TipoAssi)
	b. /CertDigital: Certificado Digital
	c. /TipoAssi: 0-NFe, 1-Cancelar e 2-Inutilizar
	d. /CodiNota: código da Nota Fiscal
O arquivo assinado é gravado no POCaNota no campo NFeNota (onde X será 0, 1 ou 2, conforme o TipoAssi) e o resultado do processo no NFeNota (mensagem de sucesso, erro,
etc.).
3) Pega Certificado: Função que retorna o certificado, conforme exemplo: EE-CERTAUXI={NF-CERTDIGIT}.
4) Valida Schema: Valida os layouts usados pelo Módulo NFe. Chamado por NFV e os parâmetros: Exemplo: NFV12345678=/TipoAssi=1/CodINota={VA=INTE0001}
   /EndeArqu: Endereço do Arquivo a ser Assinado (se o não for passado, será buscado de: C:\SAG\NFe\NFe123456-nfe.xml, onde 123456 é o código da nota, ou
              C:\SAG\NFe\lote123456-env-lote.xml, onde 123456 é o lote vindo no parâmetro CodINota)
   b. /CodINota: Código da Nota Fiscal ou do Lote
   c. /TipoVali: Tipo da Validação, podendo ser:
      /// 0 - cabeçalho (cabecMsg_v1.02)
      /// 1 - NF-e (nfe_v1.10.xsd)
      /// 2 - Envio de Lote de NF-e (envloteNFe_v1.10.xsd)
      /// 3 - Retorno Lote de NF-e (retEnviNFe_v1.10.xsd)
      /// 4 - Busca Resultado de NF-e (consReciNFe_v1.10.xsd)
      /// 5 - Retorno de Resultado de NF-e (retConsReciNFe_v1.10.xsd)
      /// 6 - Cancelamento de NF-e (cancNFe_v1.07.xsd)
      /// 7 - Retorno de Cancelamento de NF-e (retCancNFe_v1.07.xsd)
      /// 8 - Inutilizacao de Numeração de NF-e (inutNFe_v1.07.xsd)
      /// 9 - Retorno de Inutilização de NF-e (retlnutNFe_v1.07.xsd)
      /// 10 - Consulta Situação de NF-e (consSitNFe_v1.07.xsd)
      /// 11 - Retorno de Consulta Situação de NF-e (retConsSitNFe_v1.07.xsd)
      /// 12 - Consulta Status de Serviço (consStatServ_v1.07.xsd)
      /// 13 - Retorno de Consulta Status de Serviço (retConsStatServ_v1.07.xsd)
      /// 14 - Consulta Cadastro de Contribuintes (consCad_v1.01.xsd)
      /// 15 - Retorno da Consulta Cadastro de Contribuintes (retConsCad_v1.01.xsd)
5) Comunicação Web Service: Chamado por NFW, com os parâmetros: (Ex.: NFW12345678=/TipoComu=BuscLote/CertDigi={EE-CertAuxi}/UF={VA-
STRI0001}/TipoAmbi=2/EndeArqu=C:\SAG\NFe\Assinada\Lote-35-env-lot.xml/Codilote=35)
a. /CertDigi: Certificado Digital
b. /UF
c. /TipoAmbi: Tipo de Ambiente (1-Produção e 2 Homologação)
d. /TipoComu: Tipo de comunicação
	i. ENVILOTE:
	   1. /EndeArqu: Endereço do Arquivo
	   2. /Codilote: Código do Lote (Chave)
	ii. BUSCLOTE
	   1. /Codilote: Código do Lote (Chave)
	iii. CANCNOTA
	   1. /Chav: Chave (Chave)
	   2. /Prot: Protocolo
	   3. /Lice: Licença
	   4. /Just: Justificativa
	iv. INUTNOTA
	   1. /cUF_
	   2. /Ano
	   3. /CNPJ
	   4. /Mode: Modelo
	   5. /Seri: Série
	   6. /Inic: Número Inicial (Chave)
	   7. /Fina: Número Fina (Chave)
	   8. /Lice: Licença
	   9. /Just: Justificativa
	v. CONSNOTA
	   1. /Chav (Chave)
	vi. STATSERV
	vii. CONSCADA
	   1. TipoArgu: Tipo de Argumento, sendo 0 - IE, 1 - CNPJ ou 2 - CPF
	   2. Argu: Argumento, IE/CNPJ/CPF a ser pesquisado (Chave)
Todos os resultados estão gravados na tabela FSCANFEW, sendo:
a) TabeNFeW: ENVIOLOTE, BUSCLOTE, etc, no caso o parâmetro TipoComu
b) ChavNFeW: Chaves passadas, podendo ser o CodiLote, Chav, Protocolo, Argumento, etc...
c) XMLENFeW: Armazena o conteúdo do XML enviado
d) XMLCNFeW: Armazena o Cabeçalho do XML
e) XMLRNFeW: Armazena o conteúdo do XML retornado pelo WS.
f) XMLMNFeW: Armazena a mensagem do processo.


N2

Descrição: Nota Fiscal Eletrônica (Versão 2.0)

1) Gera XML: Através da chamada NFG com o código da consulta que tenha a estrutura do XML e um WHERE para esta consulta, por exemplo: NFG23010001-AND (CODINOTA IN
   (IC-NOTAAUXI))
   a. Se na consulta tiver o CertificadoDigital, as NFe's geradas já serão assinadas
   b. Se na consulta tiver o idLote, as NFe's são agrupadas num lote, sendo que após este lote será transmitido para o Web Service (WS), usando a
      UF=30_emit_enderemit_UF e TipoAmb=30_ide_tpAmb
Assina XML: Através da chamada NFA, passando os parâmetros: Exemplo: NFA12345678-/CertDigi={EE-CERTAUXI}/TipoAssi=0/CodINota={VA-INTE0001}
   a. /EnderArq: Endereço do Arquivo a ser Assinado (se o não for passado, será buscado de: C:\SAG\Nfe\123456-nfe.xml, onde 123456 é o código da nota, o nfe poderá
      ser canc ou inu, conforme o TipoAssi)
   b. /CertDigi: Certificado Digital
   c. /TipoAssi: 0-NFe, 1-Cancelar e 2-Inutilizar
   d. /CodINota: Código da Nota Fiscal
o arquivo assinado é gravado no POCNota no campo NFeXNota (onde X será 0, 1 ou 2, conforme o TipoAssi) e o resultado do processo no NFeSNota (mensagem de sucesso, erro,
etc...).
3) Pega Certificado: Função que retorna o certificado, conforme exemplo: EE-CERTAUXI-(NF-CERTDIGI).
4) Valida Schema: Valida os layouts usados pelo Módulo NFe. Chamado por NFV e os parâmetros: Exemplo: NFV12345678-/TipoAssi=1/CodINota={VA-INTE0001}
   a. /EnderArq: Endereço do Arquivo a ser Assinado (se o não for passado, será buscado de: C:\SAG\Nfe\NFe\123456-nfe.xml, onde 123456 é o código da nota, ou
      C:\SAG\Nfe\Lote\123456-env-lote.xml, onde 123456 é o lote vindo no parâmetro CodINota)
   b. /CodINota: Código da Nota Fiscal ou do lote
   c. /TipoVali: Tipo da Validação, podendo ser:
      /// 0 - cabeçalho (cabecMsg_v1.02)
      /// 1 - NF-e (nfe_v1.10.xsd)
      /// 2 - Envio de Lote de NF-e (envNFe_v1.10.xsd)
      /// 3 - Retorno Lote de NF-e (retEnvNFe_v1.10.xsd)
      /// 4 - Busca Resultado de NF-e (consReciNFe_v1.10.xsd)
      /// 5 - Retorno de Resultado de NF-e (retConsReciNFe_v1.10.xd)
      /// 6 - Cancelamento de NF-e (cancNFe_v1.07.xsd)
      /// 7 - Retorno de Cancelamento de NF-e (retCancNFe_v1.07.xsd)
      /// 8 - Inutilizacao de Numeração de NF-e (inutNFe_v1.07.xsd)
      /// 9 - Retorno de Inutilização de NF-e (retInutNFe_v1.07.xsd)
      /// 10 - Consulta Situação de NF-e (consSitNFe_v1.07.xsd)
      /// 11 - Retorno de Consulta Situação de NF-e (retConsSitNFe_v1.07.xsd)
      /// 12 - Consulta Status de Serviço (consStatServ_v1.07.xsd)
      /// 13 - Retorno de Consulta Status de Serviço (retConsStatServ_v1.07.xsd)
      /// 14 - Consulta Cadastro de Contribuintes (consCad_v1.01.xsd)
      /// 15 - Retorno da Consulta Cadastro de Contribuintes (retConsCad_v1.01.xsd)
5) Comunicação Web Service: Chamado por NFW, com os parâmetros: (Ex.: NFW12345678-/TipoComu=Busclote/CertDigi={EE-CertAuxi}/UF={VA-
   STR(0001)}/TipoAmb=2/EnderArq=C:\SAG\NFe\Assinada\Lote-35-env-lot.xml/Codilote=35)
   a. /CertDigi: Certificado Digital
   b. /UF
   c. /TipoAmb: Tipo de Ambiente (1-Produção e 2 Homologação)
   d. /TipoComu: Tipo de comunicação
      i. ENVLOTE:
         1. /EnderArq: Endereço do Arquivo
         2. /Codilote: Código do Lote (Chave)
         3. /Lice: Licença
      ii. BUSCLOTE
         1. /Codilote: Código do Lote (Chave)
      iii. CANCNOTA
         1. /Chav: Chave (Chave)
         2. /Prot: Protocolo
         3. /Lice: Licença
         4. /Just: Justificativa
      iv. INUTNOTA
         1. /CUF
         2. /Ano
         3. /CNPJ
         4. /Mode: Modelo
         5. /Seri: Série
         6. /Inic: Número Inicial (Chave)
         7. /Fina: Número Fina (Chave)
         8. /Lice: Licença
         9. /Just: Justificativa
      v. CONSNOTA
         1. /Chav (Chave)
      vi. STATSERV
      vii. CONSCADA
         1. TipoArgu: Tipo de Argumento, sendo 0 - IE, 1 - CNPJ ou 2 - CPF
         2. Argu: Argumento, IE/CNPJ/CPF a ser pesquisado (Chave)
Todos os resultados estão gravados na tabela FSCANFEW, sendo:
a) TabeNFew: ENVLOTE, BUSCLOTE, etc, no caso o parâmetro TipoComu
b) ChavNFew: Chaves passadas, podendo ser o Codilote, Chav, Protocolo, Argumento, etc...
c) XMLENFew: Armazena o conteúdo do XML enviado
d) XMLCNFew: Armazena o cabeçalho do XML
e) XMLRNFew: Armazena o conteúdo do XML retornado pelo WS.
f) XMLMNFew: Armazena a mensagem do processo.

TI

Descrição: Timer

f6.1.23.402

Pode ser ativado e desativado:

--------------------------------
TI-TEMPEMPR-DESA
TI-TEMPEMPR-ATIV
--------------------------------

O ideal, ao utilizar uma instrução nele, é na primeira instrução, desativar e na última, voltar a ativar, para caso o processo demore, não seja
chamado novamente antes do fim.

--------------------------------
TI-TEMPEMPR-DESA
MP-EX-12345678-Teste
TI-TEMPEMPR-ATIV
--------------------------------

IF

Descrição: Estrutura de decisão

------------------------------------
IF-INIC0001-IF(1=2,1,0)
   VA-INTE0001-1
IF-ELSE0001-IF(1=3,1,0)
   VA-INTE0001-2
IF-ELSE0001-
   VA-INTE0001-3
IF-FINA0001
------------------------------------

é o mesmo que

------------------------------------
IF (1=2) THEN
BEGIN
   VTESTE := 1;
END
ELSE IF (1=3) THEN
BEGIN
   VTESTE := 2;
END
ELSE
BEGIN
   VTESTE := 3;
END
------------------------------------

O IF pode ser nomeado de diversas formas, mas atenção o IF precisa ter padrão e bem definido...

Não pode:
IF-INIC0001-1
  IF-INIC0001-1
  CODIGO...
  IF-FINA0001
IF-FINA0001

Pode:
IF-INIC0001-
  IF-INIC0002-
    IF-INICTEST-
    IF-ELSETEST-
    IF-FINATEST
  IF-FINA0002
IF-FINA0001